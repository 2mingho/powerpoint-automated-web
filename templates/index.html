<!-- templates/index.html -->
{% extends 'base.html' %}
{% block title %}Inicio | Data Intel{% endblock %}

{% block content %}
  <div class="report-container">
    <h1 class="page-title">Reportes Data Intel</h1>

    <form action="/upload_csv" method="POST" enctype="multipart/form-data" onsubmit="mostrarCargando()">
      
      <!-- Selector de plantilla -->
      <div class="form-group">
        <label for="template_name">Plantilla de reporte</label>
        <select id="template_name" name="template_name" required>
          {% if available_templates %}
            {% for tpl in available_templates %}
              <option value="{{ tpl }}" {% if tpl == default_template %}selected{% endif %}>{{ tpl }}</option>
            {% endfor %}
          {% else %}
            <option value="" disabled selected>No hay plantillas disponibles</option>
          {% endif %}
        </select>
        <div class="form-group checkbox" style="margin-top:8px;">
          <input type="checkbox" id="fallback_default" name="fallback_default" checked />
          <label for="fallback_default">Usar la plantilla predeterminada si la seleccionada no existe</label>
        </div>
      </div>

      <!-- √Årea para subir el archivo -->
      <div class="upload-box">
        <div class="upload-icon">üìÅ</div>
        <div>
          <strong>Subir archivo</strong>
          <p>Selecciona o arrastra un archivo para generar un reporte de an√°lisis de datos.</p>
        </div>
        <input type="file" name="csv_file" accept=".csv" required />
      </div>

      <!-- T√≠tulo del reporte -->
      <div class="form-group">
        <label for="report_title">Nombre del reporte</label>
        <input type="text" id="report_title" name="report_title" placeholder="Ingresa un nombre para tu reporte" />
      </div>

      <!-- Descripci√≥n del reporte -->
      <div class="form-group">
        <label for="description">Descripci√≥n</label>
        <textarea id="description" name="description" placeholder="Describe brevemente el contenido del reporte"></textarea>
      </div>

      <!-- Wordcloud opcional -->
      <div class="form-group">
        <label for="wordcloud_file">Wordcloud (opcional)</label>
        <input type="file" id="wordcloud_file" name="wordcloud_file" accept="image/png" />
      </div>

      <!-- Solo fecha -->
      <div class="form-group checkbox">
        <input type="checkbox" id="solo_fecha" name="solo_fecha" />
        <label for="solo_fecha">Solo fecha</label>
      </div>

      <button type="submit">Generar reporte</button>

      <p id="mensaje-cargando" style="display: none; font-weight: bold; margin-top: 15px;">
        Procesando reporte... Esto puede tardar unos segundos.
      </p>
    </form>
  </div>

  <script>
    function mostrarCargando() {
      document.getElementById('mensaje-cargando').style.display = 'block';
    }
  </script>
{% endblock %}